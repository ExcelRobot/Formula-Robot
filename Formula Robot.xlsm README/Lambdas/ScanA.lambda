ScanA =LAMBDA(initial_value,array,function,LET(\\LambdaName, "ScanA", _IsByCol, ROWS(array) > 1, _Stack, IF(_IsByCol, VSTACK, HSTACK), _Choose, IF(_IsByCol, CHOOSECOLS, CHOOSEROWS), _Accum, REDUCE(initial_value, array, LAMBDA(hist,curr, LET(_Last, IF(_IsByCol, TAKE(hist, -1), TAKE(hist, , -1)), _Stack(hist, function(LAMBDA([n], IF(ISOMITTED(n), _Last, @_Choose(_Last, n))), curr))))), IF(_IsByCol, DROP(_Accum, 1), DROP(_Accum, , 1))));